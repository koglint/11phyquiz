<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <style>
        /* Basic styling for the entire page */
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: auto;
            background-color: #f4f4f4;
            color: #333;
        }

        /* Styling for buttons */
        button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 15px;
            font-size: 16px;
            background-color: #555; /* Dark grey */
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #333; /* Darker grey on hover */
        }

        /* Styling for the title page */
        #title-page {
            text-align: center;
            padding-top: 80px;
        }

        #title-page h1 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #333;
        }

        #title-page p {
            font-size: 18px;
            margin-bottom: 40px;
            color: #555;
        }

        #title-page button {
            width: 50%;
            margin: 10px auto;
        }

        /* Styling for the module selection page */
        #module-selection-page {
            display: none;
            text-align: center;
        }

        #module-selection-page h2 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }

        .module-button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            font-size: 18px;
            background-color: #555;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .module-button.selected {
            background-color: #007bff; /* Highlight color */
        }

        #module-selection-page button {
            width: 50%;
            margin: 20px auto;
        }

        /* Styling for the quiz container */
        #quiz-container {
            display: none;
            position: relative;
        }

        /* Feedback message styling */
        #feedback {
            font-weight: bold;
            margin-top: 20px;
            color: #333;
        }

        /* Styling for the results page */
        #results-page {
            display: none;
            text-align: center;
        }

        #results-page h1 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #333;
        }

        #results-page p {
            font-size: 24px;
            color: #555;
        }

        /* Styling for the quiz info */
        #quiz-info {
            margin-bottom: 20px;
            font-size: 18px;
            color: #555;
            text-align: center;
        }

        /* Styling for the Home button */
        #home-button {
            position: absolute;
            top: 0;
            left: 0;
            padding: 10px;
            background-color: #444;
            border-radius: 5px;
            font-size: 14px;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: auto; /* Adjust width to be based on content */
            margin-bottom: 10px;
        }

        #home-button:hover {
            background-color: #333;
        }

        /* Adjusting the h1 styling */
        h1 {
            margin-top: 40px; /* Add margin to push down "Quiz" under the Home button */
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="title-page">
        <h1>Physics Multiple Choice Revision</h1>
        <button onclick="selectMode('scored')">Start Scored Mode</button>
        <button onclick="selectMode('infinite')">Start Infinite Mode</button>
    </div>

    <div id="module-selection-page">
        <h2>Select Modules</h2>
        <button class="module-button" data-module="1" onclick="toggleModule(1)">Module 1</button>
        <button class="module-button" data-module="2" onclick="toggleModule(2)">Module 2</button>
        <button class="module-button" data-module="3" onclick="toggleModule(3)">Module 3</button>
        <button class="module-button" data-module="4" onclick="toggleModule(4)">Module 4</button>
        <button class="module-button" data-module="5" onclick="toggleModule(5)">Module 5</button>
        <button class="module-button" data-module="6" onclick="toggleModule(6)">Module 6</button>
        <button class="module-button" data-module="7" onclick="toggleModule(7)">Module 7</button>
        <button class="module-button" data-module="8" onclick="toggleModule(8)">Module 8</button>
        <button onclick="startQuiz()">Start Quiz</button>
    </div>

    <div id="quiz-container">
        <button id="home-button" onclick="goHome()">Home</button>
        <div id="quiz-info"></div>
        <h1>Quiz</h1>
        <div id="question-container">
            <p id="question"></p>
            <!-- Answer buttons -->
            <button class="answer-button">A</button>
            <button class="answer-button">B</button>
            <button class="answer-button">C</button>
            <button class="answer-button">D</button>
            <!-- Feedback and Next Question button -->
            <p id="feedback"></p>
            <button id="next-button" style="display: none;" onclick="nextQuestion()">Next Question</button>
        </div>
    </div>

    <div id="results-page">
        <h1>Results</h1>
        <p id="results"></p>
        <button onclick="restartQuiz()">Restart Quiz</button>
    </div>

    <script>
        let quiz = [];
        let filteredQuiz = [];
        let currentMode = '';
        let selectedModules = [];
        let currentQuestionIndex = 0;
        let score = 0;
        const maxQuestions = 20;

        // Function to load quiz data from the JSON file
        async function loadQuizData() {
            try {
                const response = await fetch('quizData.json');
                quiz = await response.json();
            } catch (error) {
                console.error("Failed to load quiz data:", error);
            }
        }

        // Function to show the mode selection screen
        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('title-page').style.display = 'none';
            document.getElementById('module-selection-page').style.display = 'block';
        }

        // Function to toggle module selection
        function toggleModule(module) {
            const button = document.querySelector(`button[data-module="${module}"]`);
            if (selectedModules.includes(module)) {
                selectedModules = selectedModules.filter(m => m !== module);
                button.classList.remove('selected');
            } else {
                selectedModules.push(module);
                button.classList.add('selected');
            }
        }

        // Function to filter quiz questions based on selected modules
        function filterQuestions() {
            filteredQuiz = quiz.filter(question => selectedModules.includes(question.module));
        }

        // Function to start the quiz after module selection
        async function startQuiz() {
            filterQuestions();
            if (filteredQuiz.length === 0) {
                alert('Please select at least one module.');
                return;
            }
            document.getElementById('module-selection-page').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            currentQuestionIndex = 0;
            score = 0;
            updateQuizInfo();
            loadQuestion();
        }

        // Function to update quiz info (e.g., current question number in scored mode)
        function updateQuizInfo() {
            if (currentMode === 'scored') {
                document.getElementById('quiz-info').innerText = `Question ${currentQuestionIndex + 1} of ${maxQuestions}`;
            } else {
                document.getElementById('quiz-info').innerText = '';
            }
        }

        // Function to load a new question
        function loadQuestion() {
            if (currentMode === 'scored' && currentQuestionIndex >= maxQuestions) {
                showResults();
                return;
            }

            const randomIndex = Math.floor(Math.random() * filteredQuiz.length);
            const questionData = filteredQuiz[randomIndex];

            document.getElementById('question').innerText = questionData.question;

            const answerButtons = document.querySelectorAll('.answer-button');
            answerButtons.forEach((btn, index) => {
                btn.innerText = questionData.options[index];
                btn.disabled = false;
                btn.onclick = function() {
                    checkAnswer(index, questionData);
                };
            });

            document.getElementById('feedback').innerText = "";
            document.getElementById('next-button').style.display = 'none';
        }

        // Function to check the selected answer
        function checkAnswer(selectedIndex, questionData) {
            const selectedLetter = String.fromCharCode(97 + selectedIndex); // Get 'a', 'b', 'c', 'd'
            if (selectedLetter === questionData.answer) {
                document.getElementById('feedback').innerText = "Correct! " + questionData.explanation;
                if (currentMode === 'scored') {
                    score++;
                }
            } else {
                document.getElementById('feedback').innerText = "Incorrect! The correct answer is " + questionData.answer + ". " + questionData.explanation;
            }

            // Disable buttons after selection
            document.querySelectorAll('.answer-button').forEach(btn => btn.disabled = true);

            // Show the "Next Question" button
            document.getElementById('next-button').style.display = 'block';
        }

        // Function to load the next question
        function nextQuestion() {
            currentQuestionIndex++;
            updateQuizInfo();
            loadQuestion();
        }

        // Function to show the results at the end of scored mode
        function showResults() {
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('results-page').style.display = 'block';
            document.getElementById('results').innerText = `You scored ${score} out of ${maxQuestions}.`;
        }

        // Function to restart the quiz
        function restartQuiz() {
            document.getElementById('results-page').style.display = 'none';
            document.getElementById('title-page').style.display = 'block';
        }

        // Function to go back to the home page
        function goHome() {
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('results-page').style.display = 'none';
            document.getElementById('title-page').style.display = 'block';
        }

        // Load quiz data on page load
        window.onload = loadQuizData;
    </script>
</body>
</html>
